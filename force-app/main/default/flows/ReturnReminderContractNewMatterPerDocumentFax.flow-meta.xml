<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>54.0</apiVersion>
    <assignments>
        <name>assign_ConnectErrorToDo</name>
        <label>接続失敗したToDoの変数割り当て</label>
        <locationX>438</locationX>
        <locationY>1984</locationY>
        <assignmentItems>
            <assignToReference>var_ErrorCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loop_ConnectErrorToDo.ErrorCode__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.ActivityDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>text_NotConnectErrorMessage</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>進行中</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.Subject</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>FAX連携機能への接続エラー</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.WhatId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loop_ConnectErrorToDo.RecordId__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loop_ConnectErrorToDo.OwnerId__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varCol_ConnectErrorToDo</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>var_ErrorToDoToken</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loop_ConnectErrorToDo</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assign_CountReportOutputToken</name>
        <label>コレクション変数カウント</label>
        <locationX>575</locationX>
        <locationY>850</locationY>
        <assignmentItems>
            <assignToReference>var_Count</assignToReference>
            <operator>AssignCount</operator>
            <value>
                <elementReference>varCol_ReportOutputToken</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>decision_CollectionNum</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assign_DocumentInfoReportOutputToken</name>
        <label>書類情報帳票トークン割り当て</label>
        <locationX>1046</locationX>
        <locationY>949</locationY>
        <assignmentItems>
            <assignToReference>var_ReportOutputToken.RecordId__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loop_DocumentCreateReportOutputToken.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ReportOutputToken.AccountId__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loop_DocumentCreateReportOutputToken.FirstCollectDestination__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ReportOutputToken.OwnerId__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loop_DocumentCreateReportOutputToken.Seal__r.Renewal__r.ChargeTeam__r.OwnerId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>assign_ReportOutputTokenAddCollection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assign_ErrorCode1</name>
        <label>エラーコード割り当て</label>
        <locationX>389</locationX>
        <locationY>1850</locationY>
        <assignmentItems>
            <assignToReference>var_ErrorCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loop_ConnectErrorToDo.ErrorCode__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>assign_ConnectErrorToDo</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assign_ErrorCode2</name>
        <label>エラーコード割り当て</label>
        <locationX>459</locationX>
        <locationY>2202</locationY>
        <assignmentItems>
            <assignToReference>var_ErrorCode</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loop_FaxErrorToDo.ErrorCode__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>assign_FaxErrorToDo</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assign_FaxErrorToDo</name>
        <label>FAX処理エラーのToDoの変数割り当て</label>
        <locationX>459</locationX>
        <locationY>2314</locationY>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.ActivityDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>text_FaxErrorMessage</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.Status</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>進行中</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.Subject</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>FAX処理エラー</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loop_FaxErrorToDo.OwnerId__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.WhatId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loop_FaxErrorToDo.RecordId__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varCol_FaxErrorToDo</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>var_ErrorToDoToken</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loop_FaxErrorToDo</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assign_FirstStorageSingleFaxDocument</name>
        <label>Fax対象の書類レコード割り当て</label>
        <locationX>156</locationX>
        <locationY>545</locationY>
        <assignmentItems>
            <assignToReference>varCol_FaxDocument</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>loop_FirstStorageDocument</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loop_FirstStorageDocument</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assign_NoFaxNewMatter</name>
        <label>FAXなし変数割り当て</label>
        <locationX>879</locationX>
        <locationY>668</locationY>
        <assignmentItems>
            <assignToReference>varCol_NoFaxDocuments</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>loop_DocumentCreateReportOutputToken</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loop_DocumentCreateReportOutputToken</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assign_NoFaxToDo</name>
        <label>FaxなしToDoの変数割り当て</label>
        <locationX>752</locationX>
        <locationY>1096</locationY>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.WhatId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loop_NoFaxDocument.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.ActivityDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loop_NoFaxDocument.OwnerId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.Subject</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>formula_NotSendError</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_ErrorToDoToken.Description</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Setup.Message__c.NotSendErrorMessage__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varCol_NoFaxToDo</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>var_ErrorToDoToken</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loop_NoFaxDocument</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assign_ReportOutputTokenAddCollection</name>
        <label>帳票送信トークンのコレクションへの追加</label>
        <locationX>1045</locationX>
        <locationY>1082</locationY>
        <assignmentItems>
            <assignToReference>varCol_ReportOutputToken</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>var_ReportOutputToken</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loop_DocumentCreateReportOutputToken</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assign_ResetSimilarDocumentFlag</name>
        <label>同様書類ありフラグリセット</label>
        <locationX>36</locationX>
        <locationY>473</locationY>
        <assignmentItems>
            <assignToReference>var_HasSimilarDocument</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loop_FirstStorageDocument</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assign_SimilarDocumentFlag</name>
        <label>同様書類ありフラグ割り当て</label>
        <locationX>273</locationX>
        <locationY>358</locationY>
        <assignmentItems>
            <assignToReference>var_HasSimilarDocument</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loop_ExistFirstStorageReminderFaxDocument</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>assign_SuccessDocument</name>
        <label>成功した書類レコードの変数を作成</label>
        <locationX>208</locationX>
        <locationY>1493</locationY>
        <assignmentItems>
            <assignToReference>var_DocumentRecordToken.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>loop_DocumentSuccess.RecordId__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_DocumentRecordToken.CollectScheduledDate__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>formula_DaysLater</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>varCol_DocumentSuccess</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>var_DocumentRecordToken</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loop_SearchDocument</targetReference>
        </connector>
    </assignments>
    <collectionProcessors>
        <name>filter_ReportOutputConnectError</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>帳票出力接続失敗</label>
        <locationX>590</locationX>
        <locationY>1778</locationY>
        <assignNextValueToReference>currentItem_filter_ReportOutputConnectError</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>varCol_ReportOutputToken</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_filter_ReportOutputConnectError.ResultCode__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <numberValue>1.0</numberValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>loop_ConnectErrorToDo</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>filter_ReportOutputError</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>帳票出力失敗</label>
        <locationX>595</locationX>
        <locationY>2128</locationY>
        <assignNextValueToReference>currentItem_filter_ReportOutputError</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>varCol_ReportOutputToken</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_filter_ReportOutputError.ResultCode__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <numberValue>9.0</numberValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>loop_FaxErrorToDo</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>filter_ReportOutputSuccess</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>帳票出力成功</label>
        <locationX>587</locationX>
        <locationY>1354</locationY>
        <assignNextValueToReference>currentItem_filter_ReportOutputSuccess</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>varCol_ReportOutputToken</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_filter_ReportOutputSuccess.ResultCode__c</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <numberValue>0.0</numberValue>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>loop_DocumentSuccess</targetReference>
        </connector>
    </collectionProcessors>
    <collectionProcessors>
        <name>search_Document</name>
        <elementSubtype>FilterCollectionProcessor</elementSubtype>
        <label>書類レコードを見つける</label>
        <locationX>459</locationX>
        <locationY>1413</locationY>
        <assignNextValueToReference>currentItem_search_Document</assignNextValueToReference>
        <collectionProcessorType>FilterCollectionProcessor</collectionProcessorType>
        <collectionReference>get_FirstStorageReminderDocument</collectionReference>
        <conditionLogic>and</conditionLogic>
        <conditions>
            <leftValueReference>currentItem_search_Document.Id</leftValueReference>
            <operator>EqualTo</operator>
            <rightValue>
                <elementReference>loop_DocumentSuccess.RecordId__c</elementReference>
            </rightValue>
        </conditions>
        <connector>
            <targetReference>loop_SearchDocument</targetReference>
        </connector>
    </collectionProcessors>
    <decisions>
        <name>decision_CollectionNum</name>
        <label>コレクション数判定</label>
        <locationX>568</locationX>
        <locationY>961</locationY>
        <defaultConnector>
            <targetReference>action_ReportOutputBulk2</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>デフォルトの結果</defaultConnectorLabel>
        <rules>
            <name>isZero</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>var_Count</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>loop_NoFaxDocument</targetReference>
            </connector>
            <label>コレクション数0</label>
        </rules>
    </decisions>
    <decisions>
        <name>decision_FAX</name>
        <label>FAX判定</label>
        <locationX>937</locationX>
        <locationY>813</locationY>
        <defaultConnector>
            <targetReference>assign_DocumentInfoReportOutputToken</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>FAXあり</defaultConnectorLabel>
        <rules>
            <name>isNoFax</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>loop_DocumentCreateReportOutputToken.DestinationFax__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>loop_DocumentCreateReportOutputToken</leftValueReference>
                <operator>EqualTo</operator>
            </conditions>
            <connector>
                <targetReference>assign_NoFaxNewMatter</targetReference>
            </connector>
            <label>FAXなし</label>
        </rules>
    </decisions>
    <decisions>
        <name>decision_SimilarFirstStorageDocument</name>
        <label>同様書類有無判定</label>
        <locationX>87</locationX>
        <locationY>310</locationY>
        <defaultConnector>
            <targetReference>assign_FirstStorageSingleFaxDocument</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>なし</defaultConnectorLabel>
        <rules>
            <name>IsExsistSimilarFirstStorageDocument</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>var_HasSimilarDocument</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>assign_ResetSimilarDocumentFlag</targetReference>
            </connector>
            <label>あり</label>
        </rules>
    </decisions>
    <decisions>
        <name>decision_SimilarTermFirstStorageReminderDocument</name>
        <label>同案件の同督促先の種類有無チェック</label>
        <locationX>385</locationX>
        <locationY>425</locationY>
        <defaultConnector>
            <targetReference>loop_ExistFirstStorageReminderFaxDocument</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>なし</defaultConnectorLabel>
        <rules>
            <name>IsExsist</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>loop_ExistFirstStorageReminderFaxDocument.FirstCollectDestination__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>loop_FirstStorageDocument.FirstCollectDestination__c</elementReference>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>loop_ExistFirstStorageReminderFaxDocument.Seal__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <elementReference>loop_FirstStorageDocument.Seal__c</elementReference>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>assign_SimilarDocumentFlag</targetReference>
            </connector>
            <label>あり</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>formula_DaysLater</name>
        <dataType>Date</dataType>
        <expression>TODAY()+{!loop_SearchDocument.Seal__r.Account__r.ServiceContractRenewalConditionChange__r.ContractStorageReminderAddDays__c}</expression>
    </formulas>
    <formulas>
        <name>formula_NotSendError</name>
        <dataType>String</dataType>
        <expression>{!$Setup.Subject__c.NotSendErrorSubject__c}+&quot; 五点書類の督促依頼 &quot;</expression>
    </formulas>
    <interviewLabel>NM_返送締結書類督促(Fax) {!$Flow.CurrentDateTime}</interviewLabel>
    <label>NM_返送締結書類督促(Fax)</label>
    <loops>
        <name>loop_ConnectErrorToDo</name>
        <label>接続失敗ToDoレコードループ</label>
        <locationX>589</locationX>
        <locationY>1901</locationY>
        <collectionReference>filter_ReportOutputConnectError</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>assign_ErrorCode1</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>create_ConnectErrorToDo</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>loop_DocumentCreateReportOutputToken</name>
        <label>帳票送信トークンの作成ループ</label>
        <locationX>702</locationX>
        <locationY>824</locationY>
        <collectionReference>varCol_FaxDocument</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>decision_FAX</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>assign_CountReportOutputToken</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>loop_DocumentSuccess</name>
        <label>成功した書類レコードのコレクションをループ</label>
        <locationX>598</locationX>
        <locationY>1512</locationY>
        <collectionReference>filter_ReportOutputSuccess</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>search_Document</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>update_Document</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>loop_ExistFirstStorageReminderFaxDocument</name>
        <label>Fax対象書類ループ</label>
        <locationX>482</locationX>
        <locationY>315</locationY>
        <collectionReference>varCol_FaxDocument</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>decision_SimilarTermFirstStorageReminderDocument</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>decision_SimilarFirstStorageDocument</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>loop_FaxErrorToDo</name>
        <label>Fax失敗ToDoレコードループ</label>
        <locationX>600</locationX>
        <locationY>2245</locationY>
        <collectionReference>filter_ReportOutputError</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>assign_ErrorCode2</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>create_FaxErrorToDo</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>loop_FirstStorageDocument</name>
        <label>初回保管対象督促書類ループ</label>
        <locationX>700</locationX>
        <locationY>458</locationY>
        <collectionReference>get_FirstStorageReminderDocument</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>loop_ExistFirstStorageReminderFaxDocument</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>loop_DocumentCreateReportOutputToken</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>loop_NoFaxDocument</name>
        <label>Faxなし書類レコード</label>
        <locationX>582</locationX>
        <locationY>1105</locationY>
        <collectionReference>varCol_NoFaxDocuments</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>assign_NoFaxToDo</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>create_NoFaxToDo</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>loop_SearchDocument</name>
        <label>書類レコードループ</label>
        <locationX>358</locationX>
        <locationY>1481</locationY>
        <collectionReference>search_Document</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>assign_SuccessDocument</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>loop_DocumentSuccess</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>FREE_FORM_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>create_ConnectErrorToDo</name>
        <label>接続失敗ToDo作成</label>
        <locationX>595</locationX>
        <locationY>2012</locationY>
        <connector>
            <targetReference>filter_ReportOutputError</targetReference>
        </connector>
        <inputReference>varCol_ConnectErrorToDo</inputReference>
    </recordCreates>
    <recordCreates>
        <name>create_FaxErrorToDo</name>
        <label>FAX処理エラーのToDo作成</label>
        <locationX>598</locationX>
        <locationY>2378</locationY>
        <inputReference>varCol_FaxErrorToDo</inputReference>
    </recordCreates>
    <recordCreates>
        <name>create_NoFaxToDo</name>
        <label>FaxなしToDo作成</label>
        <locationX>584</locationX>
        <locationY>1237</locationY>
        <connector>
            <targetReference>filter_ReportOutputSuccess</targetReference>
        </connector>
        <inputReference>varCol_NoFaxToDo</inputReference>
    </recordCreates>
    <recordLookups>
        <name>get_FirstStorageReminderDocument</name>
        <label>初回保管督促対象書類を取得</label>
        <locationX>700</locationX>
        <locationY>263</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>loop_FirstStorageDocument</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OperationCategory__c</field>
            <operator>EqualTo</operator>
            <value>
                <stringValue>新規</stringValue>
            </value>
        </filters>
        <filters>
            <field>IsStorageReminderTarget__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>IsNotAutoReminder__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <filters>
            <field>IsOperataionClose__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Document__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>update_Document</name>
        <label>書類レコードを更新</label>
        <locationX>589</locationX>
        <locationY>1649</locationY>
        <connector>
            <targetReference>filter_ReportOutputConnectError</targetReference>
        </connector>
        <inputReference>varCol_DocumentSuccess</inputReference>
    </recordUpdates>
    <start>
        <locationX>577</locationX>
        <locationY>50</locationY>
        <connector>
            <targetReference>get_FirstStorageReminderDocument</targetReference>
        </connector>
        <schedule>
            <frequency>Daily</frequency>
            <startDate>2022-09-23</startDate>
            <startTime>11:22:00.000Z</startTime>
        </schedule>
        <triggerType>Scheduled</triggerType>
    </start>
    <status>Draft</status>
    <subflows>
        <name>action_ReportOutputBulk2</name>
        <label>帳票一括送信</label>
        <locationX>425</locationX>
        <locationY>1047</locationY>
        <connector>
            <targetReference>loop_NoFaxDocument</targetReference>
        </connector>
        <flowName>ReportOutputBulk</flowName>
        <inputAssignments>
            <name>var_InputReportName</name>
            <value>
                <stringValue>F_ReturnReminderContractNewMatterPerDocumentFax</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>varCol_RportOutputToken</name>
            <value>
                <elementReference>varCol_ReportOutputToken</elementReference>
            </value>
        </inputAssignments>
        <outputAssignments>
            <assignToReference>varCol_ReportOutputToken</assignToReference>
            <name>varCol_OutputRportOutputToken</name>
        </outputAssignments>
    </subflows>
    <textTemplates>
        <name>text_FaxErrorMessage</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>﻿{!$Setup.Message__c.FaxErrorMessage__c}
﻿エラーコード：{!var_ErrorCode}</text>
    </textTemplates>
    <textTemplates>
        <name>text_NotConnectErrorMessage</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>{!var_ErrorCode}
{!$Setup.Message__c.FaxConnectErrorMessage__c}</text>
    </textTemplates>
    <variables>
        <name>currentItem_filter_ReportOutputConnectError</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ReportOutputToken__c</objectType>
    </variables>
    <variables>
        <name>currentItem_filter_ReportOutputError</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ReportOutputToken__c</objectType>
    </variables>
    <variables>
        <name>currentItem_filter_ReportOutputSuccess</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ReportOutputToken__c</objectType>
    </variables>
    <variables>
        <name>currentItem_filter_SimilarTermDocument</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Document__c</objectType>
    </variables>
    <variables>
        <name>currentItem_search_Document</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Document__c</objectType>
    </variables>
    <variables>
        <name>currentItem_search_Seal</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Seal__c</objectType>
    </variables>
    <variables>
        <name>var_Count</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
    <variables>
        <name>var_DocumentRecordToken</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Document__c</objectType>
    </variables>
    <variables>
        <name>var_ErrorCode</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
    <variables>
        <name>var_ErrorToDoToken</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Task</objectType>
    </variables>
    <variables>
        <name>var_HasSimilarDocument</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>var_RecordReportMasterToken</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ReportMaster__c</objectType>
    </variables>
    <variables>
        <name>var_ReportOutputToken</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ReportOutputToken__c</objectType>
    </variables>
    <variables>
        <name>varCol_ConnectErrorToDo</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Task</objectType>
    </variables>
    <variables>
        <name>varCol_DocumentSuccess</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Document__c</objectType>
    </variables>
    <variables>
        <name>varCol_FaxDocument</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Document__c</objectType>
    </variables>
    <variables>
        <name>varCol_FaxErrorToDo</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Task</objectType>
    </variables>
    <variables>
        <name>varCol_NoFaxDocuments</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Document__c</objectType>
    </variables>
    <variables>
        <name>varCol_NoFaxToDo</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Task</objectType>
    </variables>
    <variables>
        <name>varCol_ReportOutputToken</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ReportOutputToken__c</objectType>
    </variables>
</Flow>
